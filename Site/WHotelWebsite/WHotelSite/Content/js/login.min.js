var _loginModular = { setpwdBackTag: "reg", _ckFun: function () { }, _cancelFun: function () { }, _hideCancel: !1, _followUserId: 0, _followNickName: "", _invitationCode: "", _onlyPhoneLogin: !1, _useGeetest: !0, _onlyUseForget: !1, _forgetCallback: function () { }, init: function (a, b, c) { var e, d = this; d.createLoginElement(), d._ckFun = a, d._cancelFun = b, d._hideCancel = c, d._useGeetest && $.ajax({ url: "/account/GetCaptcha?t=" + (new Date).getTime(), type: "get", dataType: "json", success: function (a) { initGeetest({ gt: a.gt, challenge: a.challenge, product: "bind", offline: !a.success, width: "100%" }, function (a) { e = a }) } }), this._loginModel = $(".login-model"), this._loginSection = $(".login-section"), this._login_block = $("._login_block"), this._input_login_phone = this._loginSection.find("._input_login_phone"), this._input_login_pwd = this._loginSection.find("._input_login_pwd"), this._btn_login = this._loginSection.find("._btn_login"), this._btn_gophonelogin = this._loginSection.find("._btn_gophonelogin"), this._login_goreg = this._loginSection.find("._login_goreg"), this._login_findpwd = this._loginSection.find("._login_findpwd"), this._login2_block = $("._login2_block"), this._input_login2_phone = this._loginSection.find("._input_login2_phone"), this._input_login2_code = this._loginSection.find("._input_login2_code"), this._login2_getcode = this._loginSection.find("._login2_getcode"), this._btn_login2 = this._loginSection.find("._btn_login2"), this._btn_gologin = this._loginSection.find("._btn_gologin"), this._reg_block = $("._reg_block"), this._input_reg_phone = this._loginSection.find("._input_reg_phone"), this._input_reg_code = this._loginSection.find("._input_reg_code"), this._reg_getcode = this._loginSection.find("._reg_getcode"), this._btn_reg_next = this._loginSection.find("._btn_reg_next"), this._setpwd_block = $("._setpwd_block"), this._input_set_pwd1 = this._loginSection.find("._input_set_pwd1"), this._input_set_pwd2 = this._loginSection.find("._input_set_pwd2"), this._btn_set_ok = this._loginSection.find("._btn_set_ok"), this._findpwd_block = $("._findpwd_block"), this._input_find_phone = this._loginSection.find("._input_find_phone"), this._input_find_code = this._loginSection.find("._input_find_code"), this._find_getcode = this._loginSection.find("._find_getcode"), this._btn_find_next = this._loginSection.find("._btn_find_next"), this._login_close = this._loginSection.find("._login_close"), this._login2_close = this._loginSection.find("._login2_close"), this._reg_back = this._loginSection.find("._reg_back"), this._set_back = this._loginSection.find("._set_back"), this._find_back = this._loginSection.find("._find_back"), this._reg_nopwd_back = this._loginSection.find("._reg_nopwd_back"), this._reg_nopwd_block = $("._reg_nopwd_block"), this._input_reg_nopwd_phone = this._loginSection.find("._input_reg_nopwd_phone"), this._input_reg_nopwd_code = this._loginSection.find("._input_reg_nopwd_code"), this._input_reg_nopwd_invitation = this._loginSection.find("._input_reg_nopwd_invitation"), this._reg_nopwd_getcode = this._loginSection.find("._reg_nopwd_getcode"), this._reg_nopwd_ck = this._loginSection.find("._ck")[0], this._btn_reg_nopwd_next = this._loginSection.find("._btn_reg_nopwd_next"), this._reg_nopwd_complate_block = $("._reg_nopwd_complate_block"), this._btn_login.click(function () { var c, b = d._input_login_phone.val(); return 11 != b.length ? (alert("您输入的" + b + "有误，请输入有效的11位手机号"), void 0) : d.isMobile(b) ? (c = d._input_login_pwd.val(), c.length < 6 ? (alert("请输入正确的密码"), void 0) : ($.post(d.verify.verifyCkLoginUrl, { number: b, password: c, isSaveCookie: !1 }, "json").then(function (b) { var c, e, f, g, h; "" == b.Message ? (c = b.token, e = b.isv, f = b.nn, g = b.uid, h = { token: c, isv: e, nn: f, uid: g }, d.verify.setLoginConfigCache(h), $.post(d.verify.verifyGoLoginUrl, h, "json").then(function (b) { "" == b.Message ? a(g) : alert("登录失败") }).fail(function () { alert("网络请求失败") })) : "0" == b.Message ? alert("该手机号还没有注册") : "1" == b.Message ? alert("您的手机号或密码错误") : alert("登录失败") }).fail(function () { alert("网络请求失败") }), void 0)) : (alert("请输入有效的手机号"), void 0) }), this._input_login_pwd.click(function () { var a = $(this); d.reviewDivScrollTop(a) }), this._login2_getcode.click(function () { var a = d._input_login2_phone.val(); return 11 != a.length ? (alert("您输入的" + a + "有误，请输入有效的11位手机号"), void 0) : d.isMobile(a) ? (d._useGeetest ? (e.verify(), e.onSuccess(function () { var b = e.getValidate(), c = b.geetest_challenge, f = b.geetest_seccode, g = b.geetest_validate; d.verify.sendAndGeetest(c, f, g, a, function (a) { d._login2_getcode.toggleClass("disabled", a).prop("disabled", a), a || d._login2_getcode.text("重发验证码") }, function (a) { d._login2_getcode.text(a + "秒后可重发") }) })) : d.verify.send(a, function (a) { d._login2_getcode.toggleClass("disabled", a).prop("disabled", a), a || d._login2_getcode.text("重发验证码") }, function (a) { d._login2_getcode.text(a + "秒后可重发") }), void 0) : (alert("请输入有效的手机号"), void 0) }), this._btn_login2.click(function () { var c, f, g, h, i, j, k, b = d._input_login2_phone.val(); return 11 != b.length ? (alert("您输入的" + b + "有误，请输入有效的11位手机号"), void 0) : d.isMobile(b) ? (c = d._input_login2_code.val(), 0 == c.length ? (alert("请输入短信验证码"), void 0) : (f = "", g = !1, h = 0, i = "", j = $("#hidCurUserCID").val(), k = $("#hidWxUnionid").val(), $.post(d.verify.verifyRegisterForInvitationUrl, { number: b, password: f, code: c, invCode: i, isFollow: g, followUserId: h, CID: j, Unionid: k }, "json").then(function (b) { b ? b.Success ? d.verify.loginByUid(b.UserID, function () { a(b.UserID) }) : alert(b.Message) : alert("请求错误，请重试或联系我们") }), void 0)) : (alert("请输入有效的手机号"), void 0) }), this._reg_getcode.click(function () { var a = d._input_reg_phone.val(); return 11 != a.length ? (alert("您输入的" + a + "有误，请输入有效的11位手机号"), void 0) : d.isMobile(a) ? (d._useGeetest ? (e.verify(), e.onSuccess(function () { var b = e.getValidate(), c = b.geetest_challenge, f = b.geetest_seccode, g = b.geetest_validate; $.post(d.verify.verifyExistsMobileGeetestUrl, { geetest_challenge: c, geetest_seccode: f, geetest_validate: g, number: a }, "json").then(function (b) { b.isExists ? alert("该手机号已注册") : d.verify.send(a, function (a) { d._reg_getcode.toggleClass("disabled", a).prop("disabled", a), a || d._reg_getcode.text("重发验证码") }, function (a) { d._reg_getcode.text(a + "秒后可重发") }) }) })) : $.post(d.verify.verifyExistsMobileUrl, { number: a }, "json").then(function (b) { b.isExists ? alert("该手机号已注册") : d.verify.send(a, function (a) { d._reg_getcode.toggleClass("disabled", a).prop("disabled", a), a || d._reg_getcode.text("重发验证码") }, function (a) { d._reg_getcode.text(a + "秒后可重发") }) }), void 0) : (alert("请输入有效的手机号"), void 0) }), this._input_reg_code.click(function () { var a = $(this); d.reviewDivScrollTop(a) }), this._btn_reg_next.click(function () { var b, a = d._input_reg_phone.val(); return 11 != a.length ? (alert("您输入的" + a + "有误，请输入有效的11位手机号"), void 0) : d.isMobile(a) ? (b = d._input_reg_code.val(), 0 == b.length ? (alert("请输入短信验证码"), void 0) : ($.post(d.verify.verifyNewUserUrl, { action: "check", number: a, code: b, CID: $("#hidCurUserCID").val(), Unionid: $("#hidWxUnionid").val() }, "json").then(function (a) { "1" == a.ok ? (d.setpwdBackTag = "reg", d._setpwd_block.fadeIn(), d._input_set_pwd1.val(""), d._input_set_pwd2.val(""), d._reg_block.hide()) : alert("短信验证码输入有误") }), void 0)) : (alert("请输入有效的手机号"), void 0) }), this._find_getcode.click(function () { var a = d._input_find_phone.val(); return 11 != a.length ? (alert("您输入的" + a + "有误，请输入有效的11位手机号"), void 0) : d.isMobile(a) ? (d._useGeetest ? (e.verify(), e.onSuccess(function () { var b = e.getValidate(), c = b.geetest_challenge, f = b.geetest_seccode, g = b.geetest_validate; $.post(d.verify.verifyExistsMobileGeetestUrl, { geetest_challenge: c, geetest_seccode: f, geetest_validate: g, number: a }, "json").then(function (b) { b.isExists ? d.verify.send(a, function (a) { d._find_getcode.toggleClass("disabled", a).prop("disabled", a), a || d._find_getcode.text("重发验证码") }, function (a) { d._find_getcode.text(a + "秒后可重发") }) : alert("该手机号还未注册") }) })) : $.post(d.verify.verifyExistsMobileUrl, { number: a }, "json").then(function (b) { b.isExists ? d.verify.send(a, function (a) { d._find_getcode.toggleClass("disabled", a).prop("disabled", a), a || d._find_getcode.text("重发验证码") }, function (a) { d._find_getcode.text(a + "秒后可重发") }) : alert("该手机号还未注册") }), void 0) : (alert("请输入有效的手机号"), void 0) }), this._input_find_code.click(function () { var a = $(this); d.reviewDivScrollTop(a) }), this._btn_find_next.click(function () { var b, a = d._input_find_phone.val(); return 11 != a.length ? (alert("您输入的" + a + "有误，请输入有效的11位手机号"), void 0) : d.isMobile(a) ? (b = d._input_find_code.val(), 0 == b.length ? (alert("请输入短信验证码"), void 0) : ($.post(d.verify.verifyNewUserUrl, { action: "check", number: a, code: b, CID: $("#hidCurUserCID").val(), Unionid: $("#hidWxUnionid").val() }, "json").then(function (a) { "1" == a.ok ? (d.setpwdBackTag = "find", d._setpwd_block.fadeIn(), d._input_set_pwd1.val(""), d._input_set_pwd2.val(""), d._findpwd_block.hide()) : alert("短信验证码输入有误") }), void 0)) : (alert("请输入有效的手机号"), void 0) }), this._btn_set_ok.click(function () { var b, c, e, f, g, a = "reg" == d.setpwdBackTag ? d._input_reg_phone.val() : "find" == d.setpwdBackTag ? d._input_find_phone.val() : ""; return d.isMobile(a) ? (b = "reg" == d.setpwdBackTag ? d._input_reg_code.val() : "find" == d.setpwdBackTag ? d._input_find_code.val() : "", 0 == b.length ? (alert("短信验证码有误"), void 0) : (c = d._input_set_pwd1.val(), c.length < 6 ? (alert("请输入有效的密码"), void 0) : (e = d._input_set_pwd2.val(), e.length < 6 ? (alert("请输入确认密码"), void 0) : c != e ? (alert("确认密码有误"), void 0) : (d._onlyUseForget ? $.post(d.verify.verifyResetPwdUrl, { password: e, code: b, number: a }, "json").then(function (b) { if (b) { alert("您的密码已经设置成功！马上去登录～"), d._input_login_phone.val(a), d._input_login_pwd.val(""), d._input_reg_phone.val(""), d._input_reg_code.val(""), d._input_set_pwd1.val(""), d._input_set_pwd1.val(""), d.hide(), d._findpwd_block.show(), d._setpwd_block.hide(); try { d._forgetCallback(a) } catch (c) { } } else alert("抱歉，密码设置失败，请稍后重试") }) : "reg" == d.setpwdBackTag ? (f = $("#hidCurUserCID").val(), g = $("#hidWxUnionid").val(), $.post(d.verify.verifyRegisterUrl, { number: a, password: e, code: b, CID: f, Unionid: g }, "json").then(function (b) { "" == b ? (alert("恭喜您已注册成为周末酒店会员！马上去登录～"), d._input_login_phone.val(a), d._input_login_pwd.val(""), d._input_reg_phone.val(""), d._input_reg_code.val(""), d._input_set_pwd1.val(""), d._input_set_pwd1.val(""), d._login_block.fadeIn(), d._setpwd_block.hide()) : alert(b) })) : "find" == d.setpwdBackTag ? $.post(d.verify.verifyResetPwdUrl, { password: e, code: b, number: a }, "json").then(function (b) { b ? (alert("您的密码已经设置成功！马上去登录～"), d._input_login_phone.val(a), d._input_login_pwd.val(""), d._input_reg_phone.val(""), d._input_reg_code.val(""), d._input_set_pwd1.val(""), d._input_set_pwd1.val(""), d._login_block.fadeIn(), d._setpwd_block.hide()) : alert("抱歉，密码设置失败，请稍后重试") }) : alert("非法操作"), void 0)))) : (alert("手机号码有误"), void 0) }), this._input_reg_nopwd_phone.change(function () { var a = d._input_reg_nopwd_phone.val(); (!a || d.isMobile(a)) && d.regnopwdRefInputState() }), this._input_reg_nopwd_code.change(function () { var a = d._input_reg_nopwd_code.val(); a && 0 == a.length || d.regnopwdRefInputState() }), this._input_reg_nopwd_code.focus(function () { var a = $(this); d.reviewDivScrollTop(a) }), this._input_reg_nopwd_invitation.focus(function () { var a = $(this); d.reviewDivScrollTop(a) }), this._reg_nopwd_getcode.click(function () { var a = d._input_reg_nopwd_phone.val(); return 11 != a.length ? (alert("您输入的" + a + "有误，请输入有效的11位手机号"), void 0) : d.isMobile(a) ? ($.post(d.verify.verifyExistsMobileUrl, { number: a }, "json").then(function (b) { b.isExists ? alert("该手机号已注册") : d.verify.send(a, function (a) { d._reg_nopwd_getcode.toggleClass("disabled", a).prop("disabled", a), a || d._reg_nopwd_getcode.text("重发验证码") }, function (a) { d._reg_nopwd_getcode.text(a + "秒后可重发") }) }), void 0) : (alert("请输入有效的手机号"), void 0) }), this._btn_reg_nopwd_next.click(function () { var b, c, f, g, h, i, j, a = d._input_reg_nopwd_phone.val(); return d.isMobile(a) ? (b = d._input_reg_nopwd_code.val(), 0 == b.length ? (alert("短信验证码有误"), void 0) : (c = d._input_reg_nopwd_invitation.val(), console.log(c), f = "", g = d._reg_nopwd_ck.checked, h = d._followUserId, i = $("#hidCurUserCID").val(), j = $("#hidWxUnionid").val(), $.post(d.verify.verifyRegisterForInvitationUrl, { number: a, password: f, code: b, invCode: c, isFollow: g, followUserId: h, CID: i, Unionid: j }, "json").then(function (a) { a ? a.Success ? (alert("登录APP所需的临时密码已随短信发送至你的手机，请妥善保管"), d._reg_nopwd_block.hide(), d._reg_nopwd_complate_block.show()) : alert(a.Message) : alert("请求错误，请重试或联系我们") }), void 0)) : (alert("手机号码有误"), void 0) }), d._followUserId > 0 && (this._login_block.hide(), this._login2_block.hide(), this._reg_nopwd_block.show()), d._invitationCode && d._invitationCode.length > 0 && d._input_reg_nopwd_invitation.attr("disabled", !0), d._hideCancel && this._login_close.hide(), this._login_close.click(function () { b() && d.hide() }), this._btn_gophonelogin.click(function () { d._login2_block.fadeIn(), d._login_block.hide() }), this._btn_gologin.click(function () { d._login_block.fadeIn(), d._login2_block.hide() }), this._login_goreg.click(function () { d._reg_block.fadeIn(), d._input_reg_phone.val(""), d._input_reg_code.val(""), d._login_block.hide() }), this._login_findpwd.click(function () { var a = d._input_login_phone.val(); d._input_find_phone.val(a), d._findpwd_block.fadeIn(), d._login_block.hide() }), this._reg_back.click(function () { d._login_block.fadeIn(), d._reg_block.hide() }), this._find_back.click(function () { d._login_block.fadeIn(), d._findpwd_block.hide() }), this._set_back.click(function () { switch (d.setpwdBackTag) { case "reg": d._reg_block.fadeIn(), d._setpwd_block.hide(); break; case "find": d._findpwd_block.fadeIn(), d._setpwd_block.hide(); break; default: d._login_block.fadeIn(), d._setpwd_block.hide() } }) }, createLoginElement: function () { var a = this, b = "<div class='login-model' style='display:none;'></div>"; b += "<div class='login-section' style='display:none;'>", b += "<div class='_login_block login-hide'>", b += "<div class='titbar'><button class='_login_close'></button><div class='_login_goreg'><a href='javascript:;' class='_login_goreg'>还没有账号?</a></div></div>", b += "<div class='_logo'><img src='http://whfront.b0.upaiyun.com/app/img/aboutapp-logo.png' alt='' /></div>", b += "<div class='_row'><input type='tel' class='_input_def _input_login_phone' placeholder='输入手机号' /></div>", b += "<div class='_row'><input type='password' class='_input_def _input_login_pwd' placeholder='输入密码' /></div>", b += "<div class='_btns'><button class='_login_btn _btn_login'>登录</button><button class='_defult_btn _btn_gophonelogin'>验证码登录</button></div>", b += "<div class='_foot'><a href='javascript:;' class='_blue_link2 _login_findpwd'>忘记密码?</a></div>", b += "</div>", b += "<div class='_login2_block'>", b += "<div class='titbar'><button class='_login_close'></button></div>", b += a._onlyPhoneLogin ? "<div class='_tit'>验证手机</div>" : "<div class='_tit'>验证码登录</div>", b += "<div class='_row'><input type='tel' class='_input_def _input_login2_phone' placeholder='输入手机号' /></div>", b += "<div class='_row'><input type='number' class='_input_code _input_login2_code' placeholder='输入验证码' /><a href='javascript:;' class='_getcode _login2_getcode'>发送验证码</a></div>", b += a._onlyPhoneLogin ? "<div class='_btns'><button class='_login_btn _btn_login2'>确定</button></div>" : "<div class='_btns'><button class='_login_btn _btn_login2'>登录</button><button class='_defult_btn _btn_gologin'>密码登录</button></div>", b += "</div>", b += "<div class='_reg_block login-hide'>", b += "<div class='titbar'><button class='_login_back _reg_back'></button></div>", b += "<div class='_tit'>使用手机号注册</div>", b += "<div class='_row'><input type='tel' class='_input_def _input_reg_phone' placeholder='输入手机号' /></div>", b += "<div class='_row'><input type='number' class='_input_code _input_reg_code' placeholder='输入验证码' /><a href='javascript:;' class='_getcode _reg_getcode'>发送验证码</a></div>", b += "<div class='_btns'><button class='_login_btn _btn_reg_next'>下一步</button></div>", b += "<div class='_foot'><a href='http://www.zmjiudian.com/Account/ContractDescription' target='_blank' class='_blue_link1'>周末酒店用户协议</a></div>", b += "</div>", b += "<div class='_setpwd_block login-hide'>", b += "<div class='titbar'><button class='_login_back _set_back'></button></div>", b += "<div class='_tit'>设置密码</div>", b += "<div class='_row'><input type='password' class='_input_def _input_set_pwd1' placeholder='设置6-13位数字和字母密码' /></div>", b += "<div class='_row'><input type='password' class='_input_def _input_set_pwd2' placeholder='请再输入一遍' /></div>", b += "<div class='_btns'><button class='_login_btn _btn_set_ok'>完成</button></div>", b += "</div>", b += "<div class='_findpwd_block login-hide'>", b += "<div class='titbar'><button class='_login_back _find_back'></button></div>", b += "<div class='_tit'>忘记密码</div>", b += "<div class='_row'><input type='tel' class='_input_def _input_find_phone' placeholder='输入手机号' /></div>", b += "<div class='_row'><input type='number' class='_input_code _input_find_code' placeholder='输入验证码' /><a href='javascript:;' class='_getcode _find_getcode'>发送验证码</a></div>", b += "<div class='_btns'><button class='_login_btn _btn_find_next'>下一步</button></div>", b += "</div>", b += "<div class='_reg_nopwd_block login-hide'>", b += "<div class='titbar' style='display:none;'><button class='_login_back _reg_nopwd_back'></button></div>", b += "<div class='_tit2'>现在注册</div>", b += "<div class='_row'><input type='tel' class='_input_def _input_reg_nopwd_phone' placeholder='输入手机号' /></div>", b += "<div class='_row'><input type='number' class='_input_code _input_reg_nopwd_code' placeholder='输入验证码' /><a href='javascript:;' class='_getcode _reg_nopwd_getcode'>发送验证码</a></div>", b += "<div class='_row'><input type='text' class='_input_def _input_def2 _input_reg_nopwd_invitation' placeholder='输入邀请码（选填）' value='" + a._invitationCode + "' /></div>", b += "<div class='_row'><span class='_text'></span></div>", b += "<div class='_ctrl'><input type='checkbox' class='_ck' checked='checked' name='_ck_follow' /><label for='_ck_follow'>关注" + a._followNickName + "动态</label></div>", b += "<div class='_btns _btns2'><button class='_login_btn _btn_reg_nopwd_next' disabled='true'>注册</button></div>", b += "<div class='_foot'><a href='http://www.zmjiudian.com/Account/ContractDescription' target='_blank' class='_blue_link1'>周末酒店用户协议</a></div>", b += "</div>", b += "<div class='_reg_nopwd_complate_block login-hide'>", b += "<div class='_row'><img class='_top_img' src='http://whfront.b0.upaiyun.com/app/img/fund/invitation-reg-complate-topbg.png' alt='' /></div>", b += "<div class='_row'>", b += "<div class='_alert-t1'>注册成功</div>", b += "<div class='_alert-t2'>请到周末酒店APP->我的页面<br />查看已获得的积分</div>", b += "</div>", b += "<div class='_btns _btns2'>", b += "<a class='_downapp_btn' href='http://app.zmjiudian.com' target='_blank'>下载周末酒店APP</a>", b += "</div>", b += "<div class='_btns _btns2'>", b += "<a class='_look_btn' href='/App/MorePackageList?albumId=10' target='_blank'>查看优惠酒店</a>", b += "</div>", b += "</div>", b += "</div>", $("body").append(b) }, show: function () { var a = this; a._loginModel.show(), a._loginSection.show() }, showForget: function (a) { var b = this; b._login_block.hide(), b._login2_block.hide(), b._findpwd_block.show(), a && (b._forgetCallback = a), b._find_back.unbind("click"), b._find_back.click(function () { b.hide() }), b._onlyUseForget = !0, b._loginModel.show(), b._loginSection.show() }, hide: function () { this._loginModel.hide(), this._loginSection.hide() }, isMobile: function (a) { return phoneNumReg.test(a) }, regnopwdRefInputState: function () { var a = this, b = a._input_reg_nopwd_phone.val(), c = a._input_reg_nopwd_code.val(); a.isMobile(b) && c.length > 0 ? a._btn_reg_nopwd_next.attr("disabled", !1) : a._btn_reg_nopwd_next.attr("disabled", !0) }, _reviewDivScrollTopTimer: null, reviewDivScrollTop: function (a) { var b = this; clearTimeout(b._reviewDivScrollTopTimer), b._reviewDivScrollTopTimer = setTimeout(function () { b._loginSection.animate({ scrollTop: a.offset().top - 100 }, 300) }, 200) }, verify: { verifyUrl: window.httpsWebUrl + "Account/Verify", verifyGeetestUrl: window.httpsWebUrl + "Account/VerifyGeetest", verifyNewUserUrl: window.httpsWebUrl + "Account/VerifyNewUser", verifyCkLoginGeetestUrl: window.httpsWebUrl + "Account/VerifyLoginGeetest", verifyCkLoginUrl: window.httpsWebUrl + "Account/VerifyLogin", verifyCkLoginByUidUrl: window.httpsWebUrl + "Account/VerifyLoginByUid", verifyGoLoginUrl: "/Account/Login", verifyRegisterUrl: window.httpsWebUrl + "Account/Register", verifyRegisterForInvitationUrl: window.httpsWebUrl + "Account/RegisterForInvitation", verifyResetPwdUrl: window.httpsWebUrl + "Account/ResetPasswordWithPhone", verifyExistsMobileUrl: window.httpsWebUrl + "Account/ExistsMobileAccount", verifyExistsMobileGeetestUrl: window.httpsWebUrl + "Account/ExistsMobileAccountGeetest", _loginConfigCacheKey: "zmjd_login_cache", send: function (a, b, c) { var d = this; d._timer || (d._startTimer(b, c), $.post(d.verifyUrl, { action: "send", number: a }, "json").then(function (a) { a.ok || (d._stopTimer(b), alert("系统故障，请稍后重试或联系技术支持")) }).fail(function () { d._stopTimer(b), alert("网络请求失败") })) }, sendAndGeetest: function (a, b, c, d, e, f) { var g = this; g._timer || (g._startTimer(e, f), $.post(g.verifyGeetestUrl, { action: "sendAndGeetest", number: d, geetest_challenge: a, geetest_seccode: b, geetest_validate: c }, "json").then(function (a) { a.ok || (g._stopTimer(e), alert("系统故障，请稍后重试或联系技术支持")) }).fail(function () { g._stopTimer(e), alert("网络请求失败") })) }, check: function (a, b) { return $.post(verifyNewUserUrl, { action: "check", number: a, code: b, CID: $("#hidCurUserCID").val(), Unionid: $("#hidWxUnionid").val() }, "json").then(function (b) { return contacts._store(a) }) }, autoLogin: function (a) { var b = this, c = b.getLoginConfigCache(); return c && c.token ? ($.post(b.verifyGoLoginUrl, c, "json").then(function (b) { "" == b.Message ? a(c.uid) : alert("自动登录失败") }).fail(function () { console.log("网络请求失败") }), !0) : !1 }, loginByUid: function (a, b) { var c = this; $.post(c.verifyCkLoginByUidUrl, { uid: a }, "json").then(function (a) { var d, e, f, g, h; "" == a.Message ? (d = a.token, e = a.isv, f = a.nn, g = a.uid, h = { token: d, isv: e, nn: f, uid: g }, c.setLoginConfigCache(h), $.post(c.verifyGoLoginUrl, h, "json").then(function (a) { if ("" == a.Message) try { b(g) } catch (c) { } else console.log("登录失败") }).fail(function () { console.log("网络请求失败") })) : console.log("登录失败") }).fail(function () { console.log("网络请求失败") }) }, setLoginConfigCache: function (a) { Store.Set(this._loginConfigCacheKey, a) }, getLoginConfigCache: function () { return Store.Get(this._loginConfigCacheKey) }, _startTimer: function (a, b) { var c = this; c._dest = (new Date).getTime() + 6e4, c._timer = setInterval(function () { var d = Math.max(0, 0 | (c._dest - new Date) / 1e3); d > 0 ? b(d) : c._stopTimer(a) }, 1e3), a(!0) }, _stopTimer: function (a) { clearInterval(this._timer), this._timer = null, a(!1) } } };